<!DOCTYPE html>
<html lang="en">

<head>
    <title id="big-title">General Skywalker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="author" content="Rimbault Enzo">
    <link rel="icon" type="image/png" href="../image-perso/gas/gas-image.png">
    <link rel="stylesheet" href="../style/unit-style.css">
</head>

<body class="simple" data-unit-id="general skywalker">
    <header class="perso" style="display: flex; align-items: center;">
        <div style="flex: 0 0 20%; display: flex; justify-content: center; align-items: center;">
            <img src="../image-perso/gas/gas-image.png" alt="General Skywalker"
                style="max-width: 100%; max-height: 100%;">
        </div>
        <div style="flex: 1; padding-left: 20px;">
            <!-- S√©lecteur de langue -->
            <div class="language-switcher">
                <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Flag_of_France.svg" alt="Fran√ßais"
                    id="lang-fr"
                    style="cursor:pointer; width:32px; height:32px; border:2px solid transparent; border-radius:50%;">
                <img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" alt="English"
                    id="lang-en"
                    style="cursor:pointer; width:32px; height:32px; border:2px solid transparent; border-radius:50%;">
            </div>

            <h1 id="title"><u>General Skywalker</u></h1>
            <p id="description">Fierce Jedi Attacker who protects his battalion at all costs.</p>
            <br>

            <!-- üîÑ NAVIGATION DYNAMIQUE -->
            <nav id="unit-nav" class="perso" style="font-size: 20px;"></nav>
        </div>
    </header>

    <br>
    <img class="first" src="../image-perso/gas/General-skywalker.png" alt="General Skywalker"><br>

    <!-- Capacit√©s (inchang√©) -->
         <h2 class="titre" id="basic-attack-title"><u>Basic Attack: Furious Slash</u></h2>
    <div class="capacity-container">
        <div class="left-column">
            <img class="attaque" alt="Gas basic" src="../image-perso/gas/gas-basic.png">
        </div>
        <div class="right-column">
            <p class="attaque" id="basic-attack">
                Deal Physical damage to target enemy. This attack can't be evaded and has +65% Defense Penetration, tripled if all allies are 501st.<br><br>
                If this is the first ability General Skywalker uses during his turn, he immediately uses the Special ability Telekinesis, if able.<br><br>
                <u class="speciale">Telekinesis:</u> Deal Physical damage to target enemy. If possible, this attack will critically hit enemies with Armor Shred. If the target enemy is Dazed, reduce General Skywalker's ability cooldowns by 1.
            </p>
        </div>
    </div>

    <h2 class="titre" id="special-attack1-title"><u>Special Attack: Sundering Strike (cooldown: 3)</u></h2>
    <div class="capacity-container">
        <div class="left-column">
            <img class="attaque" alt="Gas special 1" src="../image-perso/gas/gas-spe1.png">
        </div>
        <div class="right-column">
            <p class="attaque" id="special-attack1">
                Deal Physical damage to target enemy and inflict Armor Shred. If they are Dazed, this attack deals double damage.<br><br>
                If this is the first ability General Skywalker uses during his turn, reset Force Grip's cooldown and use it if possible.
            </p>
        </div>
    </div>

    <h2 class="titre" id="special-attack2-title"><u>Special Attack: Force Grip (cooldown: 3)</u></h2>
    <div class="capacity-container">
        <div class="left-column">
            <img class="attaque" alt="Gas special 2" src="../image-perso/gas/gas-spe2.png">
        </div>
        <div class="right-column">
            <p class="attaque" id="special-attack2">
                Deal Physical damage to all enemies and Daze them for 2 turns. If possible, this attack will critically hit enemies with Armor Shred.<br><br>
                If this is the first ability General Skywalker uses during his turn, reset Sundering Strike's cooldown and use it if possible.
            </p>
        </div>
    </div>

    <h2 class="titre" id="lead-ability-title"><u>Leader Ability: General of the 501st</u></h2>
    <div class="capacity-container">
        <div class="left-column">
            <img class="attaque" alt="Gas lead" src="../image-perso/gas/gas-lead.png">
        </div>
        <div class="right-column">
            <p class="attaque" id="lead-ability">
                All units can't be revived.<br>
                All 501st allies have +50% Critical Damage.<br>
                When an enemy gains a buff, all 501st allies gain 2% Offense (stacking) until the end of the encounter.<br><br>
                While there are other active 501st allies, General Skywalker:<br>
                - Can't drop below 100% Health<br>
                - Advances if he has 100% Protection and takes Cover if he has 0% Protection at the end of every turn<br>
                - Removes all other status effects when he takes Cover<br>
                - Leaves Cover, recovers 100% Protection, and takes a bonus turn when all other 501st allies are defeated<br><br>
                <u class="speciale">Advance:</u><br>
                - Taunt, which can't be dispelled or prevented<br>
                - Other 501st allies can't lose Health<br><br>
                <u class="speciale">Cover:</u><br>
                - Can't be targeted<br>
                - Immune to damage and status effects<br>
                - Speed set to 0<br>
                - Recover 10% Protection and Turn Meter at the end of every turn, doubled for allied 501st turns, which can't be prevented.
            </p>
        </div>
    </div>

    <h2 class="titre" id="unique-ability1-title"><u>Unique Ability: The Chosen One</u></h2>
    <div class="capacity-container">
        <div class="left-column">
            <img class="attaque" alt="Gas unique 1" src="../image-perso/gas/gas-unique.png">
        </div>
        <div class="right-column">
            <p class="attaque" id="unique-ability1">
                General Skywalker uses an additional ability during his turn.<br><br>
                Whenever General Skywalker critically hits an enemy during his turn, increase their cooldowns by 1 (excluding raid bosses and Galactic Legends), which can't be resisted.<br><br>
                If he is critically hit, General Skywalker dispels all debuffs on himself. Enemies attacking out of turn can't critically hit.<br><br>
                If the target enemy has no Protection when General Skywalker uses an ability, reduce their current Max Health by 20% for rest of the battle (stacking, excluding raid bosses and Galactic Legends), which can't be resisted.
            </p>
        </div>
    </div>

    <h2 class="titre" id="unique-ability2-title"><u>Unique Ability: Hero with no Fear</u></h2>
    <div class="capacity-container">
        <div class="left-column">
            <img class="attaque" alt="Gas unique 2" src="../image-perso/gas/gas-unique2.png">
        </div>
        <div class="right-column">
            <p class="attaque" id="unique-ability2">
                At the start of battle, General Skywalker gains 25% Defense, 15% Max Protection, and 25% Tenacity for each other 501st ally until all other 501st allies are defeated.<br><br>
                If all allies are 501st at the start of battle, General Skywalker gains the following:<br><br>
                - 100% counter chance and 50% Critical Chance.<br><br>
                - When all other allies are defeated, General Skywalker can't be critically hit and gains 35% Turn Meter after every enemy turn.
            </p>
        </div>
    </div>

    <footer>
        <button onclick="scrollToTop()" id="scrollBtn" title="Go to top">Top</button>
        <script src="../javascript/bouton.js"></script>

        <!-- üåê Script de traduction -->
        <script>
            const translationsFr = {
                "big-title" : "G√©n√©ral Skywalker",
                "title" : "<u>G√©n√©ral Skywalker</u>",
                "description" : "Brave assaillant Jedi qui prot√®ge son bataillon co√ªte que co√ªte.",
                "basic-attack-title" : "<u>Attaque Basique : Taillade Furieuse</u>",
                "basic-attack" : "Inflige des d√©g√¢ts physiques √† une cible ennemie. Cette attaque ne peut pas √™tre esquiv√©e et b√©n√©ficie d'un bonus de +65% de p√©n√©tration de d√©fens, tripl√© si tous les alli√©s font partie de la 501e.\n\n Si cette capacite est la premi√®re qu'utilise le g√©n√©ral Skywalker lors de son tour, il utilise imm√©diatement la capacit√© sp√©ciale T√©l√©kin√©sie si disponible.\n\n<u class='speciale'>T√©l√©kin√©sie:</u> Inflige des d√©g√¢ts physiques √† une cible ennemie. Si possible, cette attaque inflige un coup critique aux ennemis sous l'effet d'une destruction d'armure. Si la cible ennemie souffre de confusion, r√©duit les d√©lais des capacit√© du g√©n√©ral Skywalker de 1.",
                "special-attack1-title" : "<u>Attaque Sp√©ciale : Frappe d√©chirante (d√©lai: 3)</u>",
                "special-attack1" : "Inflige des d√©g√¢ts physiques et la destruction d'armure √† une cible ennemie. Si la cible souffre de confusion, cette attaque inflige deux fois plus de d√©g√¢ts.\n\n Si cette attaque est la premi√®re qu'utilise le G√©n√©ral Skywalker lors de son tour, le d√©lai de Pr√©hension de Force est r√©initialis√© et la capacit√© est utilis√©e si possible.",
                "special-attack2-title" : "<u>Attaque Sp√©ciale : Pr√©hension de Force (d√©lai: 3)</u>",
                "special-attack2" : "Inflige des d√©g√¢ts physiques √† tous les ennemis et les rends confus pendant 2 tours. Si possible, cette attaque porte un coup critique aux ennemis sous l'effet d'une destruction d'armure.\n\n Si cette capacit√© est la premi√®re qu'utilise le G√©n√©ral Skywlaker lors de son tour, le d√©lai de Frappe d√©chirante est r√©initialis√© et la capacit√© est utilis√©e si possible.",
                "lead-ability-title" : "<u>Capacit√© de chef: G√©n√©ral de la 501e</u>",
                "lead-ability" : "Aucune unit√© ne peut √™tre ranim√©e. Tous les alli√©s de la 501e b√©n√©ficient de +50% de d√©g√¢ts critiques. Lorsqu'un ennemi obtient une am√©lioration, tous les alli√©s de la 501e obtiennent 2% d'attaque (cumulatif) jusqu'√† la fin de l'affrontement. \n\n En pr√©sence d'alli√©s de la 501e actif, le g√©n√©ral Skywalker:\n\n -ne peut pas descendre sous 100% de sant√©\n\n -avance s'il b√©n√©ficie de 100% de protection et il se met √† couvert s'il b√©n√©ficie de 0% de protection √† la fin de son tour.\n\n-Supprime tous les autres effets quand il se met √† couvert\n\n-Sort de sa position √† couvert, r√©cup√®re 100% de protection et utilise un tour bonus quand tous les autres alli√©s de la 501e sont vaincus.\n\n <u class='speciale'>Avanc√©e:</u>\n\n-Utilise la raillerie (ne peut pas √™tre dissip√© ou √©vit√©)\n\n-les autres alli√©s de la 501e ne peuvent pas perdre de sant√©.\n\n<u class='speciale'>A couvert:</u>\n\n-Ne peut pas √™tre pris pour cible.\n\n-immunit√© aux d√©g√¢ts et effets.\n\n-Vitesse √† 0.\n\n-R√©cup√®re 10% de protection et de jauge de tour √† la fin de chaque tour, doubl√© pour les tours alli√©s de la 501e (ne peut pas √™tre √©vit√©).",
                "unique-ability1-title" : "<u>Capacit√© Unique : L'√©lu</u>",
                "unique-ability1" : "Le g√©n√©ral Skywalker utilise une capacit√© suppl√©mentaire lors de son tour.\n\n Lorsque le g√©n√©ral Skywalker inflige un coup critique √† un ennemi lors de son tour, il augmente les d√©lais de celui-ci de 1 (√† l'exception des boss de raid et des L√©gendes Galactiques). Cet effet ne peut pas √™tre r√©sist√©.\n\n S'il subit un coup critique, le g√©n√©ral Skywlaker dissipe tous les affaiblissements qu'il subit. Les ennemis qui attaquent en dehors de leur tour ne peuvent pas infliger de coups critiques.\n\n Si la cible ne dispose pas de protection quand le g√©n√©ral Skywalker utilise une capacit√©, la sant√© maximale de celle-ci diminue de 20% pour le reste de l'affrontement (cumulatif, √† l'exception des boss de raid et des L√©gendes Galactiques). Cet effet ne peut pas √™tre r√©sist√©.",
                "unique-ability-title2" : "<u>Capacit√© Unique : H√©ros sans peur</u>",
                "unique-ability2" : "Au d√©but de l'affrontement, le G√©n√©ral Skywalker obtient un bonus de 25% de d√©fense, 15% de protection max, et 25% de t√©nacit√© pour chaque autre alli√© de la 501e jusqu'√† ce que tous les alli√©s de la 501e soient vaincus.\n\n Si tous les alli√©s au d√©but de l'affrontement font partie de la 501e, le g√©n√©ral Skywalker obtient les avantages suivants:\n\n -100% de chances de contre-attaque et 50% de chances de coup critique.\n\n -Quand tous les autres alli√©s sont vaincus, le G√©n√©ral Skywalker ne peut pas subir de coup critique et sa jauge de tour se remplit de 35% √† la fin de chaque tour ennemi.",
                };

            const originalTexts = {};

            function saveOriginalTexts() {
                for (const id in translationsFr) {
                    const el = document.getElementById(id);
                    if (el) originalTexts[id] = el.innerHTML;
                }
            }

            function switchLanguageTo(lang) {
                sessionStorage.setItem("selectedLanguage", lang);

                if (lang === "fr") {
                    for (const [id, text] of Object.entries(translationsFr)) {
                        const el = document.getElementById(id);
                        if (el) el.innerHTML = text;
                    }
                } else if (lang === "en") {
                    for (const [id, text] of Object.entries(originalTexts)) {
                        const el = document.getElementById(id);
                        if (el) el.innerHTML = text;
                    }
                }

                updateFlagActive();
                // Recharge la navigation dans la bonne langue
                loadUnitNavigation();
            }

            function updateFlagActive() {
                const lang = sessionStorage.getItem("selectedLanguage") || "en";
                document.getElementById("lang-en").style.borderColor = (lang === "en" ? "#007bff" : "transparent");
                document.getElementById("lang-fr").style.borderColor = (lang === "fr" ? "#007bff" : "transparent");
            }

            window.addEventListener("load", () => {
                saveOriginalTexts();
                const lang = sessionStorage.getItem("selectedLanguage") || "en";
                switchLanguageTo(lang);

                document.getElementById("lang-fr").addEventListener("click", () => switchLanguageTo("fr"));
                document.getElementById("lang-en").addEventListener("click", () => switchLanguageTo("en"));
            });
        </script>

        <!-- üß© Script de navigation dynamique -->
        <script>
            async function loadUnitNavigation() {
                try {
                    // Charger les 4 fichiers JSON en parall√®le
                    const [units, factions, roles, alignments] = await Promise.all([
                        fetch("../filtre-recherche/units.json").then(res => res.json()),
                        fetch("../data/faction.json").then(res => res.json()),
                        fetch("../data/roles.json").then(res => res.json()),
                        fetch("../data/alignements.json").then(res => res.json())
                    ]);

                    // ‚úÖ Identifier l‚Äôunit√© √† partir du data-id
                    const unitId = document.body.dataset.unitId?.toLowerCase();
                    const unit = units.find(u => u.id.toLowerCase() === unitId);
                    if (!unit) {
                        console.warn("Unit√© non trouv√©e dans units.json :", unitId);
                        return;
                    }

                    const lang = sessionStorage.getItem("selectedLanguage") || "en";
                    const nav = document.getElementById("unit-nav");
                    nav.innerHTML = ""; // Nettoyage

                    // üü¶ ALIGNEMENT
                    const align = alignments.find(a => a.en.toLowerCase() === unit.alignment.en.toLowerCase());
                    if (align) addNavLink(nav, align.url, align[lang], "capacite", true);

                    // üü© ROLE
                    const role = roles.find(r => r.en.toLowerCase() === unit.role.en.toLowerCase());
                    if (role) addNavLink(nav, role.url, role[lang], "class");

                    // üü® FACTIONS
                    for (const f of unit.factions) {
                        const factionData = factions.find(x => x.en.toLowerCase() === f.en.toLowerCase());
                        if (factionData) {
                            addNavLink(nav, factionData.url, factionData[lang], "capacite");
                        } else {
                            // Fallback si faction absente du JSON
                            addNavLink(nav, `../classement-perso/${slugify(f[lang])}.html`, f[lang], "capacite");
                        }
                    }

                } catch (err) {
                    console.error("Erreur lors du chargement des JSON :", err);
                }
            }

            // Fonctions utilitaires
            function slugify(text) {
                return text
                    .toLowerCase()
                    .replace(/[√©√®√™√´]/g, "e")
                    .replace(/[√†√¢√§]/g, "a")
                    .replace(/[√Æ√Ø]/g, "i")
                    .replace(/[√¥√∂]/g, "o")
                    .replace(/[√π√ª√º]/g, "u")
                    .replace(/[^a-z0-9]+/g, "-")
                    .replace(/(^-|-$)/g, "");
            }

            function addNavLink(nav, href, text, className, blue = false) {
                const a = document.createElement("a");
                a.href = href;
                a.className = className;
                a.textContent = text;
                if (blue) a.style.color = "blue";
                nav.appendChild(a);
            }

            // Lancer au chargement
            window.addEventListener("load", loadUnitNavigation);
        </script>
    </footer>
</body>
</html>
